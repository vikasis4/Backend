{"ast":null,"code":"import _regeneratorRuntime from \"/root/rankboost/deployment/website/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"/root/rankboost/deployment/website/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { useCallback, useLayoutEffect, useState } from 'react';\nimport { createDispatcher, usePlayerContext as useContext, findPlayer } from '@vime/core';\n\nvar noop = function noop() {};\n/**\n * Returns the closest ancestor player to the given `ref`.\n */\n\n\nexport var usePlayer = function usePlayer(ref) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      player = _useState2[0],\n      setPlayer = _useState2[1];\n\n  useLayoutEffect(function () {\n    function find() {\n      var _a;\n\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.t0 = setPlayer;\n\n                if (!ref.current) {\n                  _context.next = 16;\n                  break;\n                }\n\n                _context.next = 4;\n                return findPlayer(ref.current);\n\n              case 4:\n                _context.t3 = _a = _context.sent;\n                _context.t2 = _context.t3 !== null;\n\n                if (!_context.t2) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _context.t2 = _a !== void 0;\n\n              case 8:\n                if (!_context.t2) {\n                  _context.next = 12;\n                  break;\n                }\n\n                _context.t4 = _a;\n                _context.next = 13;\n                break;\n\n              case 12:\n                _context.t4 = null;\n\n              case 13:\n                _context.t1 = _context.t4;\n                _context.next = 17;\n                break;\n\n              case 16:\n                _context.t1 = null;\n\n              case 17:\n                _context.t5 = _context.t1;\n                (0, _context.t0)(_context.t5);\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n    }\n\n    find();\n  }, [ref.current]);\n  return player;\n};\n/**\n * Binds the given `prop` to the closest ancestor player of the given `ref`. When the property\n * changes on the player, this hook will trigger a re-render with the new value.\n *\n * @param ref The ref to start searching from.\n * @param prop The property to bind to.\n * @param defaultValue The initial value of the property until the the player context is bound.\n */\n\nexport var usePlayerContext = function usePlayerContext(ref, prop, defaultValue) {\n  var _useState3 = useState(defaultValue),\n      _useState4 = _slicedToArray(_useState3, 2),\n      value = _useState4[0],\n      setValue = _useState4[1];\n\n  var dispatch = useCallback(ref.current === null ? noop : createDispatcher(ref.current), [ref.current]);\n  var setter = useCallback( // eslint-disable-next-line @typescript-eslint/no-shadow\n  function (value) {\n    dispatch(prop, value);\n  }, [dispatch, prop]);\n  useLayoutEffect(function () {\n    if (ref.current === null) return undefined;\n    var cleanup;\n\n    function connect() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return useContext(ref.current, [prop], function (_, newValue) {\n                  setValue(newValue);\n                });\n\n              case 2:\n                cleanup = _context2.sent;\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n    }\n\n    connect();\n    return function () {\n      cleanup === null || cleanup === void 0 ? void 0 : cleanup();\n    };\n  }, [ref.current, prop]);\n  return [value, setter];\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,SAASA,WAAT,EAAsBC,eAAtB,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,SAEEC,gBAFF,EAGEC,gBAAgB,IAAIC,UAHtB,EAIEC,UAJF,QAMO,YANP;;AAQA,IAAMC,IAAI,GAAG,SAAPA,IAAO,GAAK,CAAG,CAArB;AAEA;;;;;AAGA,OAAO,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAA6C;EACpE,gBAA4BP,QAAQ,CAA6B,IAA7B,CAApC;EAAA;EAAA,IAAOQ,MAAP;EAAA,IAAeC,SAAf;;EAEAV,eAAe,CAAC,YAAK;IACnB,SAAeW,IAAf,GAAmB;;;;;;;;8BACjBD;;qBAAUF,GAAG,CAACI;;;;;;gBAAW,OAAMP,UAAU,CAACG,GAAG,CAACI,OAAL,CAAhB;;;8BAADC;8CAA+B;;;;;;;8BAAAA;;;;;;;;8BAAAA;;;;;8BAAI;;;;;;;;8BAAO;;;;;;;;;;;;;IACnE;;IAEDF,IAAI;EACL,CANc,EAMZ,CAACH,GAAG,CAACI,OAAL,CANY,CAAf;EAQA,OAAOH,MAAP;AACD,CAZM;AAqBP;;;;;;;;;AAQA,OAAO,IAAMN,gBAAgB,GAAG,SAAnBA,gBAAmB,CAC9BK,GAD8B,EAE9BM,IAF8B,EAG9BC,YAH8B,EAIZ;EAClB,iBAA0Bd,QAAQ,CAACc,YAAD,CAAlC;EAAA;EAAA,IAAOC,KAAP;EAAA,IAAcC,QAAd;;EAEA,IAAMC,QAAQ,GAAGnB,WAAW,CAC1BS,GAAG,CAACI,OAAJ,KAAgB,IAAhB,GAAuBN,IAAvB,GAA8BJ,gBAAgB,CAACM,GAAG,CAACI,OAAL,CADpB,EAE1B,CAACJ,GAAG,CAACI,OAAL,CAF0B,CAA5B;EAKA,IAAMO,MAAM,GAAGpB,WAAW,EACxB;EACA,UAACiB,KAAD,EAA0B;IACxBE,QAAQ,CAACJ,IAAD,EAAcE,KAAd,CAAR;EACD,CAJuB,EAKxB,CAACE,QAAD,EAAWJ,IAAX,CALwB,CAA1B;EAQAd,eAAe,CAAC,YAAK;IACnB,IAAIQ,GAAG,CAACI,OAAJ,KAAgB,IAApB,EAA0B,OAAOQ,SAAP;IAE1B,IAAIC,OAAJ;;IAEA,SAAeC,OAAf,GAAsB;;;;;;;gBACV,OAAMlB,UAAU,CAACI,GAAG,CAACI,OAAL,EAAe,CAACE,IAAD,CAAf,EAAuB,UAACS,CAAD,EAAIC,QAAJ,EAAgB;kBAC/DP,QAAQ,CAACO,QAAD,CAAR;gBACD,CAFyB,CAAhB;;;gBAAVH;;;;;;;;;IAGD;;IAEDC,OAAO;IACP,OAAO,YAAK;MACVD,OAAO,SAAP,WAAO,WAAP,GAAO,MAAP,UAAO,EAAP;IACD,CAFD;EAGD,CAfc,EAeZ,CAACb,GAAG,CAACI,OAAL,EAAcE,IAAd,CAfY,CAAf;EAiBA,OAAO,CAACE,KAAD,EAAQG,MAAR,CAAP;AACD,CAtCM","names":["useCallback","useLayoutEffect","useState","createDispatcher","usePlayerContext","useContext","findPlayer","noop","usePlayer","ref","player","setPlayer","find","current","_a","prop","defaultValue","value","setValue","dispatch","setter","undefined","cleanup","connect","_","newValue"],"sources":["../../src/hooks.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}